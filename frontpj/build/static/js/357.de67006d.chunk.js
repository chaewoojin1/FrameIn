"use strict";(self.webpackChunkfrontpj=self.webpackChunkfrontpj||[]).push([[357],{29:(e,s,n)=>{n.d(s,{A:()=>c});var a=n(5043),t=n(1675),o=n(3003),i=n(9740),r=n(8473),l=n(579);function c(e){var s,n;let{isDarkMode:c,setIsDarkMode:d,isMemberInfoActive:m,setIsMemberInfoActive:h}=e;const u=(0,o.wA)(),v=(0,t.Zp)(),p=(0,a.useRef)(null),g=(0,a.useRef)(null),k=(0,o.d4)((e=>e.loginSlice)),x=!!k.email,[j,w]=(0,a.useState)(""),[f,N]=(0,a.useState)(!1),[y,b]=(0,a.useState)(window.innerWidth<=1023),C=()=>{u((0,i.ri)()),alert("\ub85c\uadf8\uc544\uc6c3\ub418\uc5c8\uc2b5\ub2c8\ub2e4"),v("/",{replace:!0}),window.location.reload()},L=()=>h(!m),M=()=>N(!1);(0,a.useEffect)((()=>{const e=e=>{p.current&&!document.querySelector("header").contains(e.target)&&N(!1)},s=()=>{const e=g.current;if(!e)return;const s=e.parentElement.offsetWidth,n=e.offsetWidth;let a=16;s<n&&(a=Math.floor(s/n*16)),a>16&&(a=16),e.style.fontSize=`${a}px`},n=()=>b(window.innerWidth<=1023);return s(),window.addEventListener("resize",s),window.addEventListener("resize",n),document.addEventListener("mousedown",e),()=>{window.removeEventListener("resize",s),window.removeEventListener("resize",n),document.removeEventListener("mousedown",e)}}),[k.nickname,h]);const S=e=>{if("click"===e.type||"keydown"===e.type&&"Enter"===e.key){if(j.trim()){const e=(s=j.trim(),/^[\u3131-\u314e]+$/.test(s)),n=e?r.zp(j.trim()):j.trim(),a=e?"chosung":"normal";v(`/movie/search?query=${encodeURIComponent(n)}&searchType=${a}`)}M()}var s},A=()=>(0,l.jsxs)("div",{className:"member-info",ref:p,onClick:L,children:[(0,l.jsx)("img",{className:"member-info-img",src:"/image/person.svg",alt:"member-info"}),x&&(0,l.jsxs)("span",{ref:g,children:[k.nickname,"\ub2d8"]}),(0,l.jsx)("div",{className:"member-info-con "+(m?"active":""),children:x?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.N_,{to:"/member/detail",onClick:M,children:"\ub0b4 \uc815\ubcf4"}),(0,l.jsx)(t.N_,{to:"/cart/myCartList",onClick:M,children:"\uc7a5\ubc14\uad6c\ub2c8"}),(0,l.jsx)(t.N_,{to:"/member/myPaymentList",onClick:M,children:"\uacb0\uc81c\ub0b4\uc5ed"}),(0,l.jsx)(t.N_,{to:"/chatroom",onClick:M,children:"\uc2e4\uc2dc\uac04\ucc44\ud305"}),(0,l.jsx)(t.N_,{to:"/member/myChatList",onClick:M,children:"\ucc44\ud305\ub0b4\uc5ed"}),(0,l.jsx)("span",{onClick:C,children:"\ub85c\uadf8\uc544\uc6c3"})]}):(0,l.jsx)(t.N_,{to:"/member/login",onClick:M,children:"\ub85c\uadf8\uc778"})})]});return(0,l.jsxs)("header",{children:[(0,l.jsxs)("nav",{className:"nav",children:[(0,l.jsx)(t.N_,{to:"/",onClick:M,children:(0,l.jsx)("div",{className:"logo",children:(0,l.jsxs)("div",{className:"logo-con",children:[(0,l.jsx)("img",{src:"/image/logo.png",alt:"logo",id:"logo"}),(0,l.jsx)("span",{children:"Frame In"})]})})}),!y&&(0,l.jsxs)("div",{className:"nav-menu "+(f?"open":""),children:[(0,l.jsx)(t.N_,{to:"/",className:"nav-link",onClick:M,children:"\ud648"}),(0,l.jsx)(t.N_,{to:"/board",className:"nav-link",onClick:M,children:"\uac8c\uc2dc\ud310"}),(0,l.jsx)(t.N_,{to:"/movie/search",className:"nav-link",onClick:M,children:"\uc601\ud654 \uac80\uc0c9"}),(0,l.jsx)(t.N_,{to:"/movie/map",className:"nav-link",onClick:M,children:"\uc601\ud654\uad00"}),x&&(null===(s=k.roleNames)||void 0===s?void 0:s.includes("ADMIN"))&&(0,l.jsx)(t.N_,{to:"/admin",className:"nav-link",onClick:M,children:"ADMIN"})]})]}),y&&(0,l.jsxs)("div",{className:"mobile-nav "+(f?"open":""),children:[(0,l.jsxs)("div",{className:"search-container",children:[(0,l.jsx)("input",{type:"text",name:"search",id:"search",placeholder:"\uc601\ud654 \uac80\uc0c9",value:j,onChange:e=>w(e.target.value),onKeyDown:S}),(0,l.jsx)("img",{src:"/image/search.svg",alt:"search",className:"search-icon",onClick:S})]}),(0,l.jsxs)("div",{className:"nav-menu",children:[(0,l.jsx)(t.N_,{to:"/",className:"nav-link",onClick:M,children:"\ud648"}),(0,l.jsx)(t.N_,{to:"/board",className:"nav-link",onClick:M,children:"\uac8c\uc2dc\ud310"}),(0,l.jsx)(t.N_,{to:"/movie/search",className:"nav-link",onClick:M,children:"\uc601\ud654 \uac80\uc0c9"}),(0,l.jsx)(t.N_,{to:"/movie/map",className:"nav-link",onClick:M,children:"\uc601\ud654\uad00"}),x&&(null===(n=k.roleNames)||void 0===n?void 0:n.includes("ADMIN"))&&(0,l.jsx)(t.N_,{to:"/admin",className:"nav-link",onClick:M,children:"ADMIN"})]}),A()]}),(0,l.jsxs)("div",{className:"bar",children:[!y&&(0,l.jsxs)("div",{className:"search-container",children:[(0,l.jsx)("input",{type:"text",name:"search",id:"search",placeholder:"\uc601\ud654 \uac80\uc0c9",value:j,onChange:e=>w(e.target.value),onKeyDown:S}),(0,l.jsx)("img",{src:"/image/search.svg",alt:"search",className:"search-icon",onClick:S})]}),!y&&A(),(0,l.jsx)("div",{onClick:()=>d((e=>!e)),className:"toggle-button",role:"button",tabIndex:0,onKeyPress:e=>"Enter"===e.key&&d((e=>!e)),children:c?(0,l.jsx)("img",{src:"/image/light.svg",alt:"lightMode",id:"lightMode"}):(0,l.jsx)("img",{src:"/image/dark.svg",alt:"darkMode",id:"darkMode"})}),(0,l.jsx)("div",{className:"hamburger-menu",onClick:()=>N(!f),children:(0,l.jsx)("img",{src:f?"/image/close.svg":"/image/list.svg",alt:f?"close":"menu"})})]})]})}},3357:(e,s,n)=>{n.r(s),n.d(s,{default:()=>c});var a=n(5043),t=n(1675),o=n(29),i=n(8260),r=n(3697),l=n(579);const c=()=>{const[e,s]=(0,a.useState)(!1),[n,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)(!1),[h,u]=(0,a.useState)(!1),v=(0,t.zy)(),p=(0,a.useCallback)((()=>{const e=window.scrollY>0,s="/"===v.pathname,n=document.body.classList.contains("light"),a=(document.body.classList.contains("dark"),window.innerWidth<=1023);m(e);const t=d||a?n?"var(--color-light-2)":"var(--color-dark-2)":"transparent",o=!s||e||a?"var(--color-light-text)":"var(--color-dark-text)",i=!s||e||a?"invert(0%)":"invert(100%)",r=n?o:"var(--color-dark-text)",l=document.querySelector("header");l&&(l.style.backgroundColor=t),document.querySelectorAll("header a, header .bar img, header span").forEach((e=>{switch(e.tagName){case"A":e.style.color=n?o:"var(--color-dark-text)";break;case"IMG":e.style.filter=n?i:"invert(100%)",e.style.opacity="0.5";break;case"SPAN":e.style.color=r}}))}),[v.pathname,d]);(0,a.useEffect)((()=>{document.body.classList.toggle("dark",!e),document.body.classList.toggle("light",e);const s=()=>{p()};return s(),p(),window.addEventListener("scroll",s),()=>window.removeEventListener("scroll",s)}),[e,v.pathname,p,d]);const g=()=>{u(!h)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.A,{isDarkMode:e,setIsDarkMode:s,isMemberInfoActive:n,setIsMemberInfoActive:c,isHeaderActive:d}),(0,l.jsx)("div",{className:"container",children:(0,l.jsx)(t.sv,{})}),(0,l.jsx)(i.A,{}),h&&(0,l.jsx)(r.A,{isOpen:h,onClose:g}),(0,l.jsx)("div",{className:"chat-float-button",onClick:g,children:(0,l.jsx)("img",{className:"chat-icon",src:h?"/image/close.svg":"/image/chat.svg",alt:h?"\ub2eb\uae30":"\ucc44\ud305"})})]})}},3697:(e,s,n)=>{n.d(s,{A:()=>r});var a=n(5043),t=n(579);const o=a.memo((e=>{let{mapRef:s,isKomoranOpen:n,cinemas:o,lastLocation:i,markers:r,onMapRendered:l}=e;return(0,a.useEffect)((()=>{var e;if(s.current&&(s.current.style.width="500px",s.current.style.height="300px",s.current.style.display=n?"block":"none",null!==(e=window.kakao)&&void 0!==e&&e.maps)){const e={center:new window.kakao.maps.LatLng(37.5665,126.978),level:7},n=new window.kakao.maps.Map(s.current,e);if(o.length>0){const{lat:e,lon:s}=o[0];n.setCenter(new window.kakao.maps.LatLng(e,s)),o.forEach((e=>{const s=new window.kakao.maps.LatLng(e.lat,e.lon),a=new window.kakao.maps.Marker({position:s});a.setMap(n);const t=new window.kakao.maps.InfoWindow({content:`<div>${e.cinemaName}<br>${e.address}</div>`});window.kakao.maps.event.addListener(a,"click",(()=>{t.open(n,a)}))}))}else if(i){const{lat:e,lon:s}=i;n.setCenter(new window.kakao.maps.LatLng(e,s)),r.forEach((e=>{const s=new window.kakao.maps.LatLng(e.lat,e.lon),a=new window.kakao.maps.Marker({position:s});a.setMap(n);const t=new window.kakao.maps.InfoWindow({content:`<div>${e.cinemaName}<br>${e.address}</div>`});window.kakao.maps.event.addListener(a,"click",(()=>{t.open(n,a)}))}))}l&&l()}}),[s,n,o,i,r,l]),(0,t.jsx)("div",{id:"map",ref:s})})),i=a.memo((e=>{let{sender:s,content:n,isLastBotMessage:a,isLatestMap:i,isFirstMessage:r,mapRef:l,isKomoranOpen:c,cinemas:d,lastLocation:m,markers:h,onMapRendered:u,showTime:v}=e;return(0,t.jsxs)("div",{className:`${s}-chat`,style:r?{display:"none"}:{},children:[v&&(0,t.jsx)("div",{className:"time-display",children:(0,t.jsx)("p",{children:v})}),(0,t.jsx)("div",{className:"message",children:(0,t.jsxs)("div",{className:"part",children:["bot"===s&&a&&(0,t.jsx)("div",{className:"chat-body-logo",children:(0,t.jsx)("img",{src:"/image/logo.png",alt:"logo",id:"logo"})}),"map"===n?i?(0,t.jsx)(o,{mapRef:l,isKomoranOpen:c,cinemas:d,lastLocation:m,markers:h,onMapRendered:u}):(0,t.jsx)("p",{children:"\uc9c0\ub3c4\uac00 \uc5c5\ub370\uc774\ud2b8 \ub418\uc5c8\uc2b5\ub2c8\ub2e4."}):(0,t.jsx)("p",{className:"message-content",dangerouslySetInnerHTML:{__html:n}})]})})]})})),r=()=>{const[e,s]=(0,a.useState)(""),[n,o]=(0,a.useState)(null),[r,l]=(0,a.useState)([]),[c,d]=(0,a.useState)(null),[m,h]=(0,a.useState)([]),[u,v]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!0),[k,x]=(0,a.useState)([]),[j,w]=(0,a.useState)(null),f=(0,a.useRef)(null),N=(0,a.useRef)(null),y=(0,a.useRef)(null);(0,a.useEffect)((()=>{y.current.focus()}),[]);const b=(0,a.useCallback)((()=>{var e;if(null!==(e=window.kakao)&&void 0!==e&&e.maps)return void v(!0);const s=document.createElement("script");s.src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=190b60adafceaaa9f23691a7db8a0b39&autoload=false&libraries=services",s.async=!0,s.onload=()=>{window.kakao.maps.load((()=>{v(!0),console.log("\uce74\uce74\uc624\ub9f5 API \ub85c\ub4dc \uc131\uacf5")}))},s.onerror=()=>console.error("\uce74\uce74\uc624\ub9f5 API \ub85c\ub4dc \uc2e4\ud328"),document.head.appendChild(s)}),[]),C=(0,a.useCallback)((()=>{f.current&&(f.current.scrollTop=f.current.scrollHeight)}),[]);(0,a.useEffect)((()=>{C()}),[k,C]),(0,a.useEffect)((()=>{b(),S("\uc548\ub155")}),[b]),(0,a.useEffect)((()=>{if(n){const{poster_path:e,movieNm:s,openDt:a,audiAcc:t,overview:o}=n;L(e?`<img src="${e}" alt="${s} \ud3ec\uc2a4\ud130" class="movie-poster" />`:"\ud3ec\uc2a4\ud130 \uc774\ubbf8\uc9c0 \uc5c6\uc74c"),L(`\uc601\ud654 \uc774\ub984: ${s}`),L(`\uac1c\ubd09\uc77c: ${a}`),L(`\ub204\uc801 \uad00\uac1d\uc218: ${Number(t).toLocaleString("ko-KR")}\uba85`),L(`\uc904\uac70\ub9ac: ${o}`)}r.length>0&&u&&setTimeout((()=>{L("map")}),100)}),[n,r,u]);const L=(0,a.useCallback)((e=>{e&&x((s=>{const n=[...s,{sender:"bot",content:e,time:new Date}];return w(n.length-1),n}))}),[]),M=(0,a.useCallback)((async e=>{try{const s=await fetch("http://43.201.20.172:8090/botController",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({message:e})}),n=await s.json(),{answer:a}=n;if(r.length>0){const{lat:e,lon:s}=r[0];d({lat:e,lon:s}),h(r.map((e=>({lat:e.lat,lon:e.lon,cinemaName:e.cinemaName,address:e.address}))))}l([]),o(null),Array.isArray(a.message)?a.message.forEach((e=>L(e.message))):L(a.message),a.cinemaList&&a.cinemaList.length>0?l(a.cinemaList):a.movie&&o(a.movie),a.content&&L(a.content)}catch(s){console.error("Error sending message:",s)}}),[r,L]),S=(0,a.useCallback)((async e=>{const n=e.trim();n.length<2||(x((e=>[...e,{sender:"user",content:n,time:new Date}])),s(""),N.current&&(N.current.innerHTML="",N.current.style.width="0px",N.current.style.height="0px"),await M(n))}),[M]),A=e=>{const s=e||new Date;let n=s.getHours();const a=n>=12?"\uc624\ud6c4":"\uc624\uc804";n=n%12||12;const t=s.getMinutes();return`${a} ${n}:${t<10?"0"+t:t}`};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"komoran-container "+(p?"open":"closed"),children:[(0,t.jsxs)("div",{className:"komoran-header",children:[(0,t.jsx)("div",{className:"chat-header-logo",children:(0,t.jsx)("img",{src:"/image/logo.png",alt:"logo",id:"logo"})}),(0,t.jsx)("div",{className:"header-title",children:"Frame In"})]}),(0,t.jsxs)("div",{className:"komoran-body",ref:f,children:[(0,t.jsxs)("div",{id:"default",children:[(0,t.jsx)("div",{className:"default-img",children:(0,t.jsx)("img",{src:"/image/logo.png",alt:"logo",id:"logo"})}),(0,t.jsx)("p",{children:(0,t.jsx)("b",{children:"Frame In\uc5d0 \ubb38\uc758\ud558\uae30"})})]}),k.map(((e,s)=>{var n;let o=!1;if("map"===e.content){o=s===k.map((e=>e.content)).lastIndexOf("map")}const l=0===s&&"\uc548\ub155"===e.content,d=0===s||s>0&&A(e.time)!==A(k[s-1].time),h="bot"===e.sender&&(s===k.length-1||"user"===(null===(n=k[s+1])||void 0===n?void 0:n.sender));return(0,t.jsxs)(a.Fragment,{children:[d&&(0,t.jsx)("div",{className:"time-display",children:(0,t.jsx)("p",{children:A(e.time)})}),(0,t.jsx)(i,{sender:e.sender,content:e.content,isLastBotMessage:h,isLatestMap:o,isFirstMessage:l,mapRef:N,isKomoranOpen:p,cinemas:r,lastLocation:c,markers:m,onMapRendered:C})]},s)}))]}),(0,t.jsxs)("div",{className:"message-input",children:[(0,t.jsx)("input",{type:"text",value:e,onChange:e=>s(e.target.value),onKeyDown:s=>{"Enter"===s.key&&S(e)},ref:y}),(0,t.jsx)("button",{onClick:()=>{S(e)},children:"\uc804\uc1a1"})]})]}),(0,t.jsx)("div",{className:"chat-float-button",onClick:()=>{g((e=>!e))},children:"\ucc44\ud305"})]})}},8260:(e,s,n)=>{n.d(s,{A:()=>t});n(5043);var a=n(579);const t=()=>(0,a.jsxs)("footer",{className:"footer",children:[(0,a.jsx)("p",{children:"\uc5b4\ubca4\uc800\uc2a4 \ud300"}),(0,a.jsx)("p",{children:"\uc11c\uc6b8\ud2b9\ubcc4\uc2dc \ub178\uc6d0\uad6c \uc0c1\uacc4\ub3d9 340-6"}),(0,a.jsx)("p",{children:"\ub300\ud45c\uc774\uba54\uc77c:ex@example.com"}),(0,a.jsx)("p",{children:"\xa9 Movie. All Rights Reserved"})]})}}]);
//# sourceMappingURL=357.de67006d.chunk.js.map