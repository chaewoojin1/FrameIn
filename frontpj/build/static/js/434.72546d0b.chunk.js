"use strict";(self.webpackChunkfrontpj=self.webpackChunkfrontpj||[]).push([[434],{3434:(e,s,n)=>{n.r(s),n.d(s,{default:()=>d});var r=n(5043),i=n(1675),a=n(9320),t=n(8056),c=n(579);const l=()=>{var e,s,n,l,d,o,h;const[m,v]=(0,r.useState)(1),u=(0,i.zy)(),[j,x]=(0,r.useState)((null===(e=u.state)||void 0===e?void 0:e.movieEntity)||null),{screeningId:p}=(0,i.g)(),N=(0,i.Zp)(),f=["A","B","C","D","E","F","G","H"],g=Array.from({length:24},((e,s)=>s+1)),[y,E]=(0,r.useState)(),[k,A]=(0,r.useState)([]),[S,b]=(0,r.useState)([]),[T,w]=(0,r.useState)(window.innerWidth<=1023),R=(0,r.useRef)(null);(0,r.useEffect)((()=>{if(!(0,t.Ri)("member"))return alert("\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4."),void N("/member/login",{replace:!0});C(),$()}),[p,N]),(0,r.useEffect)((()=>{T&&R.current&&(R.current.scrollLeft=0)}),[T]);const C=async()=>{try{const e=await a.A.get(`http://43.201.20.172:8090/api/screening/info/${p}`);E(e.data),console.log("Screening info:",e.data)}catch(e){console.error("\uc0c1\uc601 \uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\ub294 \uc911 \uc624\ub958 \ubc1c\uc0dd:",e),E(null)}},$=async()=>{try{const e=await a.A.get(`http://43.201.20.172:8090/api/cart/disabledSeats/${p}`),s=Array.isArray(e.data)?e.data:[];console.log("Disabled seats:",s),b(s)}catch(e){console.error("\uc88c\uc11d \uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\ub294 \uc911 \uc624\ub958 \ubc1c\uc0dd:",e),b([])}},B=e=>{S.includes(e)||A((s=>s.includes(e)?s.filter((s=>s!==e)):[...s,e]))},O=e=>Array.isArray(S)&&S.includes(e)?"seat disabled":k.includes(e)?"seat selected":"seat available",P=Number(null===j||void 0===j?void 0:j.audiAcc)||0;return(0,c.jsx)("div",{className:"content",children:(0,c.jsx)("div",{className:"main",children:(0,c.jsxs)("div",{className:"main-con",children:[(0,c.jsx)("div",{className:"leftBar",children:(0,c.jsxs)("div",{className:"leftBar-con",children:[(0,c.jsx)("img",{src:j.poster_path,alt:j.movieNm,className:"poster"}),(0,c.jsxs)("div",{className:"movie-info",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{children:"\uc81c\ubaa9"}),(0,c.jsx)("span",{children:j.movieNm})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{children:"\uac1c\ubd09\uc77c"}),(0,c.jsx)("span",{children:j.openDt})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{children:"\uc21c\uc704"}),(0,c.jsxs)("span",{children:[j.rank,"\ub4f1"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{children:"\ub204\uc801 \uad00\uac1d \uc218"}),(0,c.jsxs)("span",{children:[P.toLocaleString("ko-KR"),"\uba85"]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{children:"\uc7a5\ub974"}),(0,c.jsx)("span",{children:j.genres})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h3",{children:"\uac10\ub3c5"}),(0,c.jsx)("span",{children:j.director})]})]})]})}),(0,c.jsxs)("div",{className:"screening-content",children:[(0,c.jsx)("div",{className:"movie-title",children:(0,c.jsx)("h1",{children:j.movieNm})}),!T&&(0,c.jsxs)("div",{className:"seat-selection-con",children:[(0,c.jsxs)("h1",{className:"seat-title",children:["\uc88c\uc11d \uc120\ud0dd (\uc601\ud654\uad00:"," ",null===y||void 0===y||null===(s=y.theaterEntity)||void 0===s||null===(n=s.cinemaEntity)||void 0===n?void 0:n.cinemaName," / \uc0c1\uc601\uad00:"," ",null===y||void 0===y||null===(l=y.theaterEntity)||void 0===l?void 0:l.name,") / \uc0c1\uc601 \ub0a0\uc9dc/\uc2dc\uac04:"," ",null===y||void 0===y?void 0:y.screeningDate," ",null===y||void 0===y?void 0:y.screeningTime]}),(0,c.jsx)("div",{className:"screen",children:"SCREEN"}),(0,c.jsx)("div",{className:"seat-container",ref:R,children:f.map((e=>(0,c.jsxs)("div",{className:"row",children:[(0,c.jsx)("span",{children:e}),(0,c.jsx)("div",{className:"seat-row",children:g.map((s=>{const n=`${e}${s}`;return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("div",{className:O(n),onClick:()=>B(n),children:s},n)})}))},e),(0,c.jsx)("span",{children:e})]})))})]}),T&&(0,c.jsxs)("div",{className:"seat-selection-con",children:[(0,c.jsxs)("h1",{className:"seat-title",children:["\uc88c\uc11d \uc120\ud0dd (\uc601\ud654\uad00:"," ",null===y||void 0===y||null===(d=y.theaterEntity)||void 0===d||null===(o=d.cinemaEntity)||void 0===o?void 0:o.cinemaName," / \uc0c1\uc601\uad00: ",null===y||void 0===y||null===(h=y.theaterEntity)||void 0===h?void 0:h.name,") / \uc0c1\uc601 \ub0a0\uc9dc/\uc2dc\uac04:"," ",null===y||void 0===y?void 0:y.screeningDate," ",null===y||void 0===y?void 0:y.screeningTime]}),(0,c.jsx)("div",{className:"screen",children:"SCREEN"}),(0,c.jsx)("div",{className:"seat-container",ref:R,children:f.map((e=>(0,c.jsx)("div",{className:"row",children:(0,c.jsx)("div",{className:"seat-row",children:g.map((s=>{const n=`${e}${s}`;return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("div",{className:O(n),onClick:()=>B(n),children:s},n)})}))},e)})))})]}),(0,c.jsxs)("div",{className:"selected-seats",children:[(0,c.jsx)("h2",{children:"\uc120\ud0dd\ub41c \uc88c\uc11d"}),k.length>0?(0,c.jsx)("p",{children:k.join(", ")}):(0,c.jsx)("p",{children:"\uc120\ud0dd\ub41c \uc88c\uc11d\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]}),(0,c.jsx)("div",{className:"cart-go",children:(0,c.jsx)("button",{onClick:async()=>{if(0===k.length)return void alert("\uc88c\uc11d\uc744 \uc120\ud0dd\ud574\uc8fc\uc138\uc694");const e={screeningId:Number(p),seats:k};console.log(" Payload to POST:",e);try{const s=await a.A.post("http://43.201.20.172:8090/api/cart/insert",e);alert(s.data),N("/cart/myCartList")}catch(r){var s,n;console.error(" POST Error:",null===(s=r.response)||void 0===s?void 0:s.data),alert((null===(n=r.response)||void 0===n?void 0:n.data)||"\uc7a5\ubc14\uad6c\ub2c8 \ucd94\uac00 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4")}},children:"\uc7a5\ubc14\uad6c\ub2c8"})})]})]})})})},d=()=>(0,c.jsx)("div",{children:(0,c.jsx)(l,{})})},9320:(e,s,n)=>{n.d(s,{A:()=>t});var r=n(6213),i=n(8056);const a=r.A.create();a.interceptors.request.use((e=>{const s=(0,i.Ri)("member");if(!s)return Promise.reject({response:{data:{error:"REQUIRE_LOGIN"}}});const{accessToken:n}=s;return e.headers.Authorization=`Bearer ${n}`,e}),(e=>Promise.reject(e))),a.interceptors.response.use((async e=>{const s=e.data;if(s&&"ERROR_ACCESS_TOKEN"===s.error){const s=(0,i.Ri)("member"),n=await(async(e,s)=>{const n={headers:{Authorization:`Bearer ${e}`}};return(await r.A.get(`http://43.201.20.172:8090/api/member/refresh?refreshToken=${s}`,n)).data})(s.accessToken,s.refreshToken);s.accessToken=n.accessToken,s.refreshToken=n.refreshToken,(0,i.TV)("member",JSON.stringify(s),1);const a=e.config;return a.headers.Authorization=`Bearer ${n.accessToken}`,await(0,r.A)(a)}return e}),(e=>Promise.reject(e)));const t=a}}]);
//# sourceMappingURL=434.72546d0b.chunk.js.map