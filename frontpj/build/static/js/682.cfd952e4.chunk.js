"use strict";(self.webpackChunkfrontpj=self.webpackChunkfrontpj||[]).push([[682],{8682:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var r=a(5043),s=a(6213),i=a(1675),n=a(3003),l=a(9320),c=a(579);const o=e=>{let{message:t,onClose:a,onConfirm:r}=e;return(0,c.jsx)("div",{className:"modal-overlay",children:(0,c.jsxs)("div",{className:"modal",children:[(0,c.jsx)("p",{style:{color:"black"},children:t}),(0,c.jsxs)("div",{className:"modal-buttons",children:[(0,c.jsx)("button",{onClick:a,className:"modal-cancel-button",children:"\uc544\ub2c8\uc624"}),(0,c.jsx)("button",{onClick:r,className:"modal-confirm-button",children:"\uc608"})]})]})})},d=()=>{var e;const{id:t}=(0,i.g)(),[a,d]=(0,r.useState)(null),[p,m]=(0,r.useState)(!0),[h,u]=(0,r.useState)(""),[y,x]=(0,r.useState)(null),[j,g]=(0,r.useState)(1),[b]=(0,r.useState)(5),[k,v]=(0,r.useState)(!1),[N,f]=(0,r.useState)(!1),[w,S]=(0,r.useState)(null),[C,$]=(0,r.useState)([]),T=(0,i.Zp)(),A=(0,n.d4)((e=>e.loginSlice));(0,r.useEffect)((()=>{(async()=>{try{const e=await s.A.get(`http://43.201.20.172:8090/board/detail/${t}`);d(e.data),m(!1)}catch(e){console.error("\uac8c\uc2dc\uae00 \uc0c1\uc138 \uc815\ubcf4 \ubd88\ub7ec\uc624\uae30 \uc2e4\ud328",e),x("\uac8c\uc2dc\uae00 \uc0c1\uc138 \uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."),m(!1)}})()}),[t]),(0,r.useEffect)((()=>{(async()=>{try{const e=(await s.A.get(`http://43.201.20.172:8090/api/reply/replyList/${t}`)).data.replyList||[];e.sort(((e,t)=>new Date(t.createTime)-new Date(e.createTime))),$(e)}catch(e){console.error("\ub313\uae00 \ub9ac\uc2a4\ud2b8 \ubd88\ub7ec\uc624\uae30 \uc2e4\ud328",e)}})()}),[t]);const L=j*b,E=L-b,D=C.slice(E,L)||[],_=e=>{g(e)},I=C.length||0,M=Math.ceil(I/b),{rangeStart:R,rangeEnd:z}=(()=>{const e=5*Math.floor((j-1)/5)+1;return{rangeStart:e,rangeEnd:Math.min(e+5-1,M)}})(),O=()=>{f(!1),S(null)},B=e=>{const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}:${String(t.getSeconds()).padStart(2,"0")}`};if(p)return(0,c.jsx)("p",{children:"\ub85c\ub529 \uc911..."});if(y)return(0,c.jsx)("p",{children:y});const P=A.email===(null===a||void 0===a?void 0:a.email)||(null===(e=A.roleNames)||void 0===e?void 0:e.includes("ADMIN"));return console.log(C),(0,c.jsxs)("div",{className:"board-detail",children:[a?(0,c.jsxs)("div",{className:"board-detail-content",children:[(0,c.jsxs)("div",{className:"board-detail-title",children:[(0,c.jsx)("span",{children:a.category}),(0,c.jsx)("span",{style:{fontSize:`${Math.max(12,30-a.title.length/2)}px`},children:a.title}),(0,c.jsxs)("div",{className:"board-detail-view",children:[(0,c.jsx)("img",{src:"../../image/eye.svg",alt:"view"}),(0,c.jsx)("span",{children:a.hit})]})]}),(0,c.jsx)("span",{children:a.memberNickName}),(0,c.jsx)("p",{className:"board-detail-content-text",children:a.content}),a.newImgName&&(0,c.jsx)("img",{src:`http://43.201.20.172:8090/upload/${a.newImgName}`,alt:a.oldImgName,style:{maxWidth:"300px",maxHeight:"300px"}}),P&&(0,c.jsxs)("div",{className:"board-detail-button",children:[(0,c.jsx)("button",{onClick:()=>{v(!0)},children:"\uc0ad\uc81c"}),(0,c.jsx)("button",{onClick:()=>T(`/board/update/${a.id}`),children:"\uc218\uc815"})]})]}):(0,c.jsx)("p",{children:"\uac8c\uc2dc\uae00\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."}),k&&(0,c.jsx)(o,{message:"\uac8c\uc2dc\uae00\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",onClose:()=>{v(!1)},onConfirm:async()=>{try{await l.A.post(`http://43.201.20.172:8090/board/delete/${t}`),T("/board")}catch(e){console.error("\uac8c\uc2dc\uae00 \uc0ad\uc81c \uc2e4\ud328",e),alert("\uac8c\uc2dc\uae00 \uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}}}),N&&(0,c.jsx)(o,{message:"\ub313\uae00\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",onClose:O,onConfirm:async()=>{if(w)try{await l.A.post(`http://43.201.20.172:8090/api/reply/delete/${w.id}/${t}`);const e=(await s.A.get(`http://43.201.20.172:8090/api/reply/replyList/${t}`)).data.replyList||[];e.sort(((e,t)=>new Date(t.createTime)-new Date(e.createTime))),$(e),O()}catch(e){console.error("\ub313\uae00 \uc0ad\uc81c \uc2e4\ud328",e),alert("\ub313\uae00 \uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}}}),(0,c.jsxs)("div",{className:"reply-list-container",children:[(0,c.jsx)("h2",{children:"\ub313\uae00 \ubaa9\ub85d"}),0===C.length?(0,c.jsx)("p",{children:"\ub313\uae00\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("ul",{className:"reply-list",children:D.map((e=>{var a,r;return(0,c.jsxs)("li",{className:"reply-item",children:[(0,c.jsx)("div",{className:"reply_nickname",children:(0,c.jsx)("span",{children:e.nickname})}),(0,c.jsx)("div",{className:"reply_content",children:(0,c.jsx)("span",{children:e.replyContent})}),(0,c.jsx)("span",{className:"reply_date",children:B(e.createTime)}),(0,c.jsx)("span",{className:"reply_content",children:e.replyText}),(0,c.jsxs)("div",{className:"reply_footer",children:[(0,c.jsxs)("div",{className:"reply_like_count",children:[(0,c.jsx)("span",{onClick:()=>(async e=>{if(!A.email)return void T("/member/login");if(C.find((t=>t.id===e)).replyLikeEntities.some((e=>e.email===A.email)))try{await l.A.post(`http://43.201.20.172:8090/api/reply/unlike?replyId=${e}&email=${A.email}`),$((t=>t.map((t=>t.id===e?{...t,replyLikeEntities:t.replyLikeEntities.filter((e=>e.email!==A.email))}:t))));const a=(await s.A.get(`http://43.201.20.172:8090/api/reply/replyList/${t}`)).data.replyList||[];a.sort(((e,t)=>new Date(t.createTime)-new Date(e.createTime))),$(a)}catch(a){console.error("\uc88b\uc544\uc694 \ucde8\uc18c \uc2e4\ud328",a),alert("\uc88b\uc544\uc694 \ucde8\uc18c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}else try{await l.A.post(`http://43.201.20.172:8090/api/reply/like?replyId=${e}&email=${A.email}`),$((t=>t.map((t=>t.id===e?{...t,replyLikeEntities:[...t.replyLikeEntities,{email:A.email}]}:t))));const a=(await s.A.get(`http://43.201.20.172:8090/api/reply/replyList/${t}`)).data.replyList||[];a.sort(((e,t)=>new Date(t.createTime)-new Date(e.createTime))),$(a)}catch(a){console.error("\uc88b\uc544\uc694 \uc2e4\ud328",a),alert("\uc88b\uc544\uc694 \ucc98\ub9ac\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}})(e.id),className:"reply_like",children:null!==(a=e.replyLikeEntities)&&void 0!==a&&a.some((e=>e.email===A.email))?"\u2764":"\u2661"}),(0,c.jsx)("span",{children:e.likeCount})]}),(A.email===e.email||(null===(r=A.roleNames)||void 0===r?void 0:r.includes("ADMIN")))&&(0,c.jsx)("span",{onClick:()=>(e=>{S(e),f(!0)})(e),children:"\uc0ad\uc81c"})]})]},e.id)}))}),(0,c.jsxs)("div",{className:"pagination",children:[(0,c.jsx)("button",{onClick:()=>_(1),disabled:1===j,children:"\ucc98\uc74c"}),(0,c.jsx)("button",{onClick:()=>_(j-1),disabled:1===j,children:"\uc774\uc804"}),[...Array(z-R+1)].map(((e,t)=>(0,c.jsx)("button",{onClick:()=>_(R+t),className:j===R+t?"active":"",children:R+t},t))),(0,c.jsx)("button",{onClick:()=>_(j+1),disabled:j===M,children:"\ub2e4\uc74c"}),(0,c.jsx)("button",{onClick:()=>_(M),disabled:j===M,children:"\ub9c8\uc9c0\ub9c9"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h2",{children:"\ub313\uae00 \uc791\uc131"}),(0,c.jsx)("form",{onSubmit:async e=>{if(!A.email)return void T("/member/login");e.preventDefault();const a={boardId:t,replyContent:h,email:A.email};try{await l.A.post("http://43.201.20.172:8090/api/reply/write",a,{headers:{"Content-Type":"application/json"}});const e=(await s.A.get(`http://43.201.20.172:8090/api/reply/replyList/${t}`)).data.replyList||[];e.sort(((e,t)=>new Date(t.createTime)-new Date(e.createTime))),$(e),u("")}catch(y){console.error("Error:",y)}},children:(0,c.jsxs)("div",{className:"boardReplyInsert",children:[(0,c.jsx)("textarea",{value:h,onChange:e=>u(e.target.value),placeholder:"\ub313\uae00\uc744 \uc791\uc131\ud574\uc8fc\uc138\uc694",required:!0}),(0,c.jsx)("button",{type:"submit",className:"reply_write",children:"\uc785\ub825"})]})})]})]})]})},p=()=>(0,c.jsx)(d,{})},9320:(e,t,a)=>{a.d(t,{A:()=>n});var r=a(6213),s=a(8056);const i=r.A.create();i.interceptors.request.use((e=>{const t=(0,s.Ri)("member");if(!t)return Promise.reject({response:{data:{error:"REQUIRE_LOGIN"}}});const{accessToken:a}=t;return e.headers.Authorization=`Bearer ${a}`,e}),(e=>Promise.reject(e))),i.interceptors.response.use((async e=>{const t=e.data;if(t&&"ERROR_ACCESS_TOKEN"===t.error){const t=(0,s.Ri)("member"),a=await(async(e,t)=>{const a={headers:{Authorization:`Bearer ${e}`}};return(await r.A.get(`http://43.201.20.172:8090/api/member/refresh?refreshToken=${t}`,a)).data})(t.accessToken,t.refreshToken);t.accessToken=a.accessToken,t.refreshToken=a.refreshToken,(0,s.TV)("member",JSON.stringify(t),1);const i=e.config;return i.headers.Authorization=`Bearer ${a.accessToken}`,await(0,r.A)(i)}return e}),(e=>Promise.reject(e)));const n=i}}]);
//# sourceMappingURL=682.cfd952e4.chunk.js.map