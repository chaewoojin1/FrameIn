"use strict";(self.webpackChunkfrontpj=self.webpackChunkfrontpj||[]).push([[645],{29:(e,n,s)=>{s.d(n,{A:()=>c});var a=s(5043),t=s(1675),o=s(3003),i=s(9740),l=s(8473),r=s(579);function c(e){var n,s;let{isDarkMode:c,setIsDarkMode:d,isMemberInfoActive:m,setIsMemberInfoActive:h}=e;const u=(0,o.wA)(),p=(0,t.Zp)(),g=(0,a.useRef)(null),v=(0,a.useRef)(null),k=(0,o.d4)((e=>e.loginSlice)),x=!!k.email,[j,f]=(0,a.useState)(""),[N,b]=(0,a.useState)(!1),[w,y]=(0,a.useState)(window.innerWidth<=1023),C=()=>{u((0,i.ri)()),alert("\ub85c\uadf8\uc544\uc6c3\ub418\uc5c8\uc2b5\ub2c8\ub2e4"),p("/",{replace:!0}),window.location.reload()},M=()=>h(!m),L=()=>b(!1);(0,a.useEffect)((()=>{const e=e=>{g.current&&!document.querySelector("header").contains(e.target)&&b(!1)},n=()=>{const e=v.current;if(!e)return;const n=e.parentElement.offsetWidth,s=e.offsetWidth;let a=16;n<s&&(a=Math.floor(n/s*16)),a>16&&(a=16),e.style.fontSize=`${a}px`},s=()=>y(window.innerWidth<=1023);return n(),window.addEventListener("resize",n),window.addEventListener("resize",s),document.addEventListener("mousedown",e),()=>{window.removeEventListener("resize",n),window.removeEventListener("resize",s),document.removeEventListener("mousedown",e)}}),[k.nickname,h]);const E=e=>{if("click"===e.type||"keydown"===e.type&&"Enter"===e.key){if(j.trim()){const e=(n=j.trim(),/^[\u3131-\u314e]+$/.test(n)),s=e?l.zp(j.trim()):j.trim(),a=e?"chosung":"normal";p(`/movie/search?query=${encodeURIComponent(s)}&searchType=${a}`)}L()}var n},_=()=>(0,r.jsxs)("div",{className:"member-info",ref:g,onClick:M,children:[(0,r.jsx)("img",{className:"member-info-img",src:"/image/person.svg",alt:"member-info"}),x&&(0,r.jsxs)("span",{ref:v,children:[k.nickname,"\ub2d8"]}),(0,r.jsx)("div",{className:"member-info-con "+(m?"active":""),children:x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.N_,{to:"/member/detail",onClick:L,children:"\ub0b4 \uc815\ubcf4"}),(0,r.jsx)(t.N_,{to:"/cart/myCartList",onClick:L,children:"\uc7a5\ubc14\uad6c\ub2c8"}),(0,r.jsx)(t.N_,{to:"/member/myPaymentList",onClick:L,children:"\uacb0\uc81c\ub0b4\uc5ed"}),(0,r.jsx)(t.N_,{to:"/chatroom",onClick:L,children:"\uc2e4\uc2dc\uac04\ucc44\ud305"}),(0,r.jsx)(t.N_,{to:"/member/myChatList",onClick:L,children:"\ucc44\ud305\ub0b4\uc5ed"}),(0,r.jsx)("span",{onClick:C,children:"\ub85c\uadf8\uc544\uc6c3"})]}):(0,r.jsx)(t.N_,{to:"/member/login",onClick:L,children:"\ub85c\uadf8\uc778"})})]});return(0,r.jsxs)("header",{children:[(0,r.jsxs)("nav",{className:"nav",children:[(0,r.jsx)(t.N_,{to:"/",onClick:L,children:(0,r.jsx)("div",{className:"logo",children:(0,r.jsxs)("div",{className:"logo-con",children:[(0,r.jsx)("img",{src:"/image/logo.png",alt:"logo",id:"logo"}),(0,r.jsx)("span",{children:"Frame In"})]})})}),!w&&(0,r.jsxs)("div",{className:"nav-menu "+(N?"open":""),children:[(0,r.jsx)(t.N_,{to:"/",className:"nav-link",onClick:L,children:"\ud648"}),(0,r.jsx)(t.N_,{to:"/board",className:"nav-link",onClick:L,children:"\uac8c\uc2dc\ud310"}),(0,r.jsx)(t.N_,{to:"/movie/search",className:"nav-link",onClick:L,children:"\uc601\ud654 \uac80\uc0c9"}),(0,r.jsx)(t.N_,{to:"/movie/map",className:"nav-link",onClick:L,children:"\uc601\ud654\uad00"}),x&&(null===(n=k.roleNames)||void 0===n?void 0:n.includes("ADMIN"))&&(0,r.jsx)(t.N_,{to:"/admin",className:"nav-link",onClick:L,children:"ADMIN"})]})]}),w&&(0,r.jsxs)("div",{className:"mobile-nav "+(N?"open":""),children:[(0,r.jsxs)("div",{className:"search-container",children:[(0,r.jsx)("input",{type:"text",name:"search",id:"search",placeholder:"\uc601\ud654 \uac80\uc0c9",value:j,onChange:e=>f(e.target.value),onKeyDown:E}),(0,r.jsx)("img",{src:"/image/search.svg",alt:"search",className:"search-icon",onClick:E})]}),(0,r.jsxs)("div",{className:"nav-menu",children:[(0,r.jsx)(t.N_,{to:"/",className:"nav-link",onClick:L,children:"\ud648"}),(0,r.jsx)(t.N_,{to:"/board",className:"nav-link",onClick:L,children:"\uac8c\uc2dc\ud310"}),(0,r.jsx)(t.N_,{to:"/movie/search",className:"nav-link",onClick:L,children:"\uc601\ud654 \uac80\uc0c9"}),(0,r.jsx)(t.N_,{to:"/movie/map",className:"nav-link",onClick:L,children:"\uc601\ud654\uad00"}),x&&(null===(s=k.roleNames)||void 0===s?void 0:s.includes("ADMIN"))&&(0,r.jsx)(t.N_,{to:"/admin",className:"nav-link",onClick:L,children:"ADMIN"})]}),_()]}),(0,r.jsxs)("div",{className:"bar",children:[!w&&(0,r.jsxs)("div",{className:"search-container",children:[(0,r.jsx)("input",{type:"text",name:"search",id:"search",placeholder:"\uc601\ud654 \uac80\uc0c9",value:j,onChange:e=>f(e.target.value),onKeyDown:E}),(0,r.jsx)("img",{src:"/image/search.svg",alt:"search",className:"search-icon",onClick:E})]}),!w&&_(),(0,r.jsx)("div",{onClick:()=>d((e=>!e)),className:"toggle-button",role:"button",tabIndex:0,onKeyPress:e=>"Enter"===e.key&&d((e=>!e)),children:c?(0,r.jsx)("img",{src:"/image/light.svg",alt:"lightMode",id:"lightMode"}):(0,r.jsx)("img",{src:"/image/dark.svg",alt:"darkMode",id:"darkMode"})}),(0,r.jsx)("div",{className:"hamburger-menu",onClick:()=>b(!N),children:(0,r.jsx)("img",{src:N?"/image/close.svg":"/image/list.svg",alt:N?"close":"menu"})})]})]})}},1645:(e,n,s)=>{s.r(n),s.d(n,{default:()=>l});var a=s(5043),t=(s(29),s(8260),s(6213)),o=s(579);const i=()=>{const[e,n]=(0,a.useState)(null),[s,i]=(0,a.useState)([]),[l,r]=(0,a.useState)([]),[c,d]=(0,a.useState)([]),[m,h]=(0,a.useState)(!1),[u,p]=(0,a.useState)([]),[g,v]=(0,a.useState)(!0),[k,x]=(0,a.useState)(null),j=(e,n,s,a)=>{const t=e=>e*(Math.PI/180),o=t(s-e),i=t(a-n),l=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t(e))*Math.cos(t(s))*Math.sin(i/2)*Math.sin(i/2);return 6371*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))};(0,a.useEffect)((()=>{N().then((e=>{const{latitude:n,longitude:s}=e.coords;x({latitude:n,longitude:s})})).catch((e=>{console.error("\uc0ac\uc6a9\uc790 \uc704\uce58\ub97c \uac00\uc838\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4.",e)}))}),[]),(0,a.useEffect)((()=>{if(m)return;const e=document.createElement("script");e.src="//dapi.kakao.com/v2/maps/sdk.js?appkey=508065e1afa2b73e19715edac2e24be9&libraries=services&autoload=false",e.async=!0,e.onload=()=>{window.kakao?kakao.maps.load((()=>{const e=document.getElementById("map"),s={center:new kakao.maps.LatLng(36.5,127.5),level:13},a=new kakao.maps.Map(e,s);n(a)})):console.error("Kakao map API did not load correctly.")},document.body.appendChild(e),h(!0)}),[m]),(0,a.useEffect)((()=>{e&&f()}),[e]),(0,a.useEffect)((()=>{e&&s.length>0&&k&&(w(),b(s))}),[k]),(0,a.useEffect)((()=>{if(!e)return;const n=()=>{const n=e.getLevel();c.forEach((s=>{s.setMap(n<=10?e:null)}))};return kakao.maps.event.addListener(e,"zoom_changed",n),()=>{kakao.maps.event.removeListener(e,"zoom_changed",n)}}),[e,c]);const f=async()=>{v(!0);try{const n=(await t.A.get("http://43.201.20.172:8090/api/cinemas")).data;i(n),p(n),w(),b(n),e.setCenter(new kakao.maps.LatLng(36.5,127.5)),e.setLevel(13)}catch(n){console.error("Failed to load cinemas:",n)}finally{v(!1)}},N=()=>new Promise(((e,n)=>{navigator.geolocation||n(new Error("Geolocation is not supported by this browser.")),navigator.geolocation.getCurrentPosition((n=>e(n)),(e=>{e.code===e.PERMISSION_DENIED?n(new Error("User denied Geolocation permission")):n(new Error("Geolocation error"))}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})})),b=n=>{if(!e)return;const s=[],a=[];n.forEach((n=>{let{lat:t,lon:o,cinemaName:i,address:l}=n;const r=new kakao.maps.LatLng(t,o),c=new kakao.maps.Marker({map:e,position:r,title:i});s.push(c);let d=`<div style="padding:5px; background:#fff; border:1px solid #ccc; font-size:12px;">\n        <strong>${i} Frame In</strong><br/>\n        ${l}<br/>`;k&&(d+=`${j(k.latitude,k.longitude,t,o).toFixed(2)} km`),d+="</div>";const m=new kakao.maps.CustomOverlay({position:r,content:d,yAnchor:1.5});e.getLevel()<=10&&m.setMap(e),a.push(m)})),r(s),d(a)},w=()=>{l.forEach((e=>e.setMap(null))),c.forEach((e=>e.setMap(null))),r([]),d([])},y=k?[...u].sort(((e,n)=>j(k.latitude,k.longitude,e.lat,e.lon)-j(k.latitude,k.longitude,n.lat,n.lon))):u;return(0,o.jsxs)("div",{className:"map-container",children:[(0,o.jsxs)("div",{className:"map-buttons",children:[(0,o.jsx)("button",{onClick:async()=>{if(e){v(!0);try{const n=await N(),{latitude:s,longitude:a}=n.coords;x({latitude:s,longitude:a});let o=(await t.A.get(`http://43.201.20.172:8090/api/cinemas/nearby?lat=${s}&lon=${a}`)).data;o.sort(((e,n)=>j(s,a,e.lat,e.lon)-j(s,a,n.lat,n.lon))),i(o),p(o),w(),b(o),e.setCenter(new kakao.maps.LatLng(s,a)),e.setLevel(8)}catch(n){console.error("Failed to load nearby cinemas:",n),"Geolocation is not supported by this browser."===n.message?alert("Geolocation is not supported by this browser."):"User denied Geolocation permission"===n.message?alert("User denied Geolocation permission."):alert("Failed to load nearby cinemas.")}finally{v(!1)}}},disabled:g,children:"\ub0b4 \uc8fc\ubcc0 \uc601\ud654\uad00 \ucc3e\uae30 \ud83c\udf9e"}),(0,o.jsx)("button",{onClick:()=>{e&&(v(!0),N().then((n=>{const{latitude:s,longitude:a}=n.coords;x({latitude:s,longitude:a});const t=new kakao.maps.LatLng(s,a);e.setCenter(t),e.setLevel(6),console.log(`\ub0b4 \uc704\uce58: \uc704\ub3c4 ${s}, \uacbd\ub3c4 ${a}`)})).catch((e=>{console.error("\uc704\uce58 \uc815\ubcf4\ub97c \uac00\uc838\uc624\ub294 \ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.",e),"Geolocation is not supported by this browser."===e.message?alert("Geolocation is not supported by this browser."):"User denied Geolocation permission"===e.message?alert("User denied Geolocation permission."):alert("Failed to load My Location.")})).finally((()=>{v(!1)})))},disabled:g,children:"\ub0b4 \uc704\uce58 \ucc3e\uae30 \ud83d\udccd"})]}),g&&(0,o.jsx)("div",{children:"Loading..."}),(0,o.jsx)("div",{id:"map",style:{width:"100%",height:"400px",marginTop:"10px"}}),y.length>0&&(0,o.jsxs)("div",{className:"map-list",children:[(0,o.jsx)("h3",{children:"\ud83d\uddfa\ufe0f \uc804\uccb4 \uc601\ud654\uad00 \ubaa9\ub85d"}),(0,o.jsx)("ul",{children:y.map(((n,s)=>(0,o.jsxs)("li",{onClick:()=>((n,s)=>{if(e){const a=new kakao.maps.LatLng(parseFloat(n),parseFloat(s));e.panTo(a),setTimeout((()=>{e.setLevel(3)}),500)}})(n.lat,n.lon),children:[(0,o.jsxs)("strong",{children:[n.cinemaName," Frame In"]}),(0,o.jsxs)("span",{children:["\ud83d\udccd ",n.address]}),k&&(0,o.jsxs)("div",{style:{fontSize:"12px",color:"#888"},children:[j(k.latitude,k.longitude,n.lat,n.lon).toFixed(2)," ","km"]})]},s)))})]})]})},l=()=>(0,o.jsx)("div",{children:(0,o.jsx)(i,{})})},8260:(e,n,s)=>{s.d(n,{A:()=>t});s(5043);var a=s(579);const t=()=>(0,a.jsxs)("footer",{className:"footer",children:[(0,a.jsx)("p",{children:"\uc5b4\ubca4\uc800\uc2a4 \ud300"}),(0,a.jsx)("p",{children:"\uc11c\uc6b8\ud2b9\ubcc4\uc2dc \ub178\uc6d0\uad6c \uc0c1\uacc4\ub3d9 340-6"}),(0,a.jsx)("p",{children:"\ub300\ud45c\uc774\uba54\uc77c:ex@example.com"}),(0,a.jsx)("p",{children:"\xa9 Movie. All Rights Reserved"})]})}}]);
//# sourceMappingURL=645.6086a639.chunk.js.map