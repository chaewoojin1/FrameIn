"use strict";(self.webpackChunkfrontpj=self.webpackChunkfrontpj||[]).push([[49],{8049:(e,s,a)=>{a.r(s),a.d(s,{default:()=>o});var t=a(5043),c=a(1675),r=a(9320),i=a(579);const n=()=>{var e;const[s,a]=(0,t.useState)([]),[n,o]=(0,t.useState)(null),[l,d]=(0,t.useState)(null),m=(0,c.Zp)(),h=(null===(e=(0,c.zy)().state)||void 0===e?void 0:e.cartItemIds)||[];(0,t.useEffect)((()=>{(async()=>{try{const e=await r.A.get("http://43.201.20.172:8090/api/myinfo/detail",{withCredentials:!0});console.log(" \uc0ac\uc6a9\uc790 \uc815\ubcf4:",e.data),d(e.data)}catch(e){console.error(" \uc0ac\uc6a9\uc790 \uc815\ubcf4 \uac00\uc838\uc624\uae30 \uc624\ub958:",e)}})()}),[]),(0,t.useEffect)((()=>{h.length>0&&(async()=>{try{const e=await r.A.post("http://43.201.20.172:8090/api/payment/orderSettlement",h,{withCredentials:!0});console.log(" \uacb0\uc81c \uc815\ubcf4:",e.data),a(e.data)}catch(e){console.error("\uacb0\uc81c \uc815\ubcf4 \uac00\uc838\uc624\uae30 \uc624\ub958:",e)}})()}),[h]);const p=s.reduce(((e,s)=>e+s.price),0);return(0,i.jsxs)("div",{className:"payment",children:[(0,i.jsx)("h1",{children:"\uacb0\uc81c \ud398\uc774\uc9c0"}),(0,i.jsxs)("div",{className:"payment-con",children:[(0,i.jsxs)("div",{className:"reservation",children:[(0,i.jsx)("h3",{children:"\uc608\ub9e4 \uc815\ubcf4"}),s.length>0?s.map(((e,s)=>(0,i.jsxs)("div",{className:"payment-item",children:[(0,i.jsx)("img",{src:e.poster_path,alt:e.movieNm}),(0,i.jsxs)("div",{className:"movieDetail",children:[(0,i.jsxs)("span",{children:[" \uc601\ud654: ",e.movieNm]}),(0,i.jsxs)("span",{children:[" \uc0c1\uc601 \ub0a0\uc9dc: ",e.screeningDate]}),(0,i.jsxs)("span",{children:[" \uc0c1\uc601 \uc2dc\uac04: ",e.screeningTime]}),(0,i.jsxs)("span",{children:[" \uc0c1\uc601\uad00: ",e.theaterName]}),(0,i.jsxs)("span",{children:[" \uc88c\uc11d \ubc88\ud638: ",e.seatNumber]}),(0,i.jsxs)("span",{children:[" \uac00\uaca9: ",e.price.toLocaleString()," \uc6d0"]}),(0,i.jsxs)("span",{children:[" \uc601\ud654\uad00: ",e.cinemaName]})]})]},s))):(0,i.jsx)("p",{children:"\uacb0\uc81c\ud560 \ud56d\ubaa9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]}),(0,i.jsxs)("div",{className:"payment-selection",children:[(0,i.jsx)("h3",{children:"\uacb0\uc81c\uc218\ub2e8"}),(0,i.jsxs)("div",{className:"payment-method-con",children:[(0,i.jsxs)("div",{className:"payment-method",children:[(0,i.jsx)("button",{className:"credit_card"===n?"selected":"",onClick:()=>o("credit_card"),children:"\uc2e0\uc6a9\uce74\ub4dc"}),(0,i.jsx)("button",{className:"kakaoPay"===n?"selected":"",onClick:()=>o("kakaoPay"),children:"\uce74\uce74\uc624\ud398\uc774"}),(0,i.jsx)("button",{className:"tossPay"===n?"selected":"",onClick:()=>o("tossPay"),children:"\ud1a0\uc2a4\ud398\uc774"}),(0,i.jsx)("button",{className:"mobile"===n?"selected":"",onClick:()=>o("mobile"),children:"\ud734\ub300\ud3f0"})]}),(0,i.jsxs)("div",{className:"payment-motion",children:["credit_card"===n&&(0,i.jsx)("div",{className:"credit-card-motion",children:(0,i.jsxs)("div",{className:"credit-card-inner",children:[(0,i.jsx)("div",{className:"credit-card-front",children:(0,i.jsx)("div",{className:"front-chip",children:(0,i.jsx)("img",{src:"./../image/chip.png",alt:"chip",className:"chip"})})}),(0,i.jsx)("div",{className:"credit-card-back",children:(0,i.jsx)("div",{className:"credit-card-back-inner"})})]})}),"kakaoPay"===n&&(0,i.jsx)("div",{className:"kakaoPay-motion",children:(0,i.jsxs)("div",{className:"kakaoPay-inner",children:[(0,i.jsx)("div",{className:"kakaoPay-front",children:(0,i.jsx)("img",{src:"./../image/kakaoPayCard.png",alt:"card",className:"card"})}),(0,i.jsx)("div",{className:"kakaoPay-back",children:(0,i.jsx)("div",{className:"kakaoPay-back-inner"})})]})}),"tossPay"===n&&(0,i.jsx)("div",{className:"tossPay-motion",children:(0,i.jsxs)("div",{className:"tossPay-inner",children:[(0,i.jsx)("div",{className:"tossPay-front",children:(0,i.jsx)("video",{autoPlay:!0,loop:!0,muted:!0,className:"tossPay-video",src:"./../video/tossMotion_dark.mp4"})}),(0,i.jsx)("div",{className:"tossPay-back",children:(0,i.jsx)("video",{autoPlay:!0,loop:!0,muted:!0,className:"tossPay-video",src:"./../video/tossMotion_light.mp4"})})]})}),"mobile"===n&&(0,i.jsx)("div",{className:"mobile-motion",children:(0,i.jsxs)("div",{className:"mobile-inner",children:[(0,i.jsx)("div",{className:"mobile-front",children:(0,i.jsx)("div",{className:"mobile-front-inner",children:(0,i.jsx)("div",{className:"notch"})})}),(0,i.jsx)("div",{className:"mobile-back",children:(0,i.jsx)("div",{className:"mobile-back-camera"})})]})})]})]})]}),(0,i.jsxs)("div",{className:"payment-go",children:[(0,i.jsx)("div",{className:"payment-go-top"}),(0,i.jsxs)("div",{className:"payment-footer",children:[(0,i.jsxs)("h2",{children:["\uacb0\uc81c \uae08\uc561: ",p.toLocaleString()," \uc6d0"]}),(0,i.jsx)("button",{onClick:async()=>{if(!n)return void alert("\uacb0\uc81c \uc218\ub2e8\uc744 \uc120\ud0dd\ud558\uc138\uc694.");if(!l)return void alert("\ub85c\uadf8\uc778 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \ub85c\uadf8\uc778\ud558\uc138\uc694.");if(0===h.length)return void alert("\uacb0\uc81c\ud560 \ud56d\ubaa9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.");console.log(" \uc7a5\ubc14\uad6c\ub2c8 \ud56d\ubaa9 ID:",h);const{IMP:e}=window;e.init("imp06751501");let s="";switch(n){case"kakaoPay":s="kakaopay.TC0ONETIME";break;case"credit_card":s="html5_inicis.INIBillTst";break;case"tossPay":s="uplus.tlgdacomxpay";break;case"mobile":s="danal_tpay.9810030929";break;default:return void alert("\uc62c\ubc14\ub978 \uacb0\uc81c \uc218\ub2e8\uc744 \uc120\ud0dd\ud558\uc138\uc694.")}console.log(" \uc120\ud0dd\ud55c PG\uc0ac:",s);const a=`order_${(new Date).getTime()}`;e.request_pay({pg:s,pay_method:"card",merchant_uid:a,name:"\uc601\ud654 \uc608\ub9e4",amount:p,buyer_email:l.email,buyer_name:l.nickname},(async e=>{if(e.success){console.log(" \uacb0\uc81c \uc131\uacf5:",e);try{console.log(" \uacb0\uc81c \uac80\uc99d \uc694\uccad \uc2dc\uc791:",e.imp_uid);const s=await r.A.post("http://43.201.20.172:8090/api/payment/verify",{imp_uid:e.imp_uid,amount:p},{withCredentials:!0});if(console.log(" \uacb0\uc81c \uac80\uc99d \uacb0\uacfc:",s.data),"\uacb0\uc81c \uac80\uc99d \uc131\uacf5"===s.data){console.log(" \uacb0\uc81c \uc815\ubcf4 \uc800\uc7a5 \uc694\uccad \uc2dc\uc791");const e=await r.A.post("http://43.201.20.172:8090/api/payment/save",{cartItemIds:h,paymentMethod:n,totalPrice:p});console.log(" \uacb0\uc81c \uc800\uc7a5 \uacb0\uacfc:",e.data),alert("\uacb0\uc81c\uac00 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),m("/")}else alert(" \uacb0\uc81c \uac80\uc99d \uc2e4\ud328")}catch(s){console.error(" \uacb0\uc81c \uac80\uc99d \ub610\ub294 \uc800\uc7a5 \uc624\ub958:",s),alert("\uacb0\uc81c \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}}else console.error(" \uacb0\uc81c \uc2e4\ud328:",e.error_msg),alert(`\uacb0\uc81c \uc2e4\ud328: ${e.error_msg}`)}))},children:"\uacb0\uc81c\ud558\uae30"})]})]})]})]})},o=()=>(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(n,{})})},9320:(e,s,a)=>{a.d(s,{A:()=>i});var t=a(6213),c=a(8056);const r=t.A.create();r.interceptors.request.use((e=>{const s=(0,c.Ri)("member");if(!s)return Promise.reject({response:{data:{error:"REQUIRE_LOGIN"}}});const{accessToken:a}=s;return e.headers.Authorization=`Bearer ${a}`,e}),(e=>Promise.reject(e))),r.interceptors.response.use((async e=>{const s=e.data;if(s&&"ERROR_ACCESS_TOKEN"===s.error){const s=(0,c.Ri)("member"),a=await(async(e,s)=>{const a={headers:{Authorization:`Bearer ${e}`}};return(await t.A.get(`http://43.201.20.172:8090/api/member/refresh?refreshToken=${s}`,a)).data})(s.accessToken,s.refreshToken);s.accessToken=a.accessToken,s.refreshToken=a.refreshToken,(0,c.TV)("member",JSON.stringify(s),1);const r=e.config;return r.headers.Authorization=`Bearer ${a.accessToken}`,await(0,t.A)(r)}return e}),(e=>Promise.reject(e)));const i=r}}]);
//# sourceMappingURL=49.e5543f24.chunk.js.map