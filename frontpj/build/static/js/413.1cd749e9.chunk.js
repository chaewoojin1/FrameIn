"use strict";(self.webpackChunkfrontpj=self.webpackChunkfrontpj||[]).push([[413],{3413:(e,s,r)=>{r.r(s),r.d(s,{default:()=>o});var t=r(5043),a=r(9320),n=r(1675),c=r(579);const i=()=>{const[e,s]=(0,t.useState)([]),[r,i]=(0,t.useState)(new Set),[o,d]=(0,t.useState)(""),l=(0,n.Zp)();(0,t.useEffect)((()=>{(async()=>{try{const e=await a.A.get("http://43.201.20.172:8090/api/cart/myCartList");console.log("API \uc751\ub2f5:",e.data),Array.isArray(e.data)?s(e.data):s([])}catch(e){console.error("\uc7a5\ubc14\uad6c\ub2c8 \ubd88\ub7ec\uc624\uae30 \uc624\ub958:",e),s([])}})()}),[]);const h=e.filter((e=>r.has(e.id))).reduce(((e,s)=>e+s.price),0),m=e.length>0&&r.size===e.length;return(0,c.jsx)("div",{className:"cart",children:(0,c.jsxs)("div",{className:"cart-con",children:[(0,c.jsx)("h1",{children:"\ub0b4 \uc7a5\ubc14\uad6c\ub2c8 \ub9ac\uc2a4\ud2b8"}),o&&(0,c.jsx)("div",{style:{color:"var(--color-red)"},children:o}),e.length>0?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"select-all",children:[(0,c.jsx)("span",{children:m?"\uc804\uccb4\uc120\ud0dd\ud574\uc81c":"\uc804\uccb4\uc120\ud0dd"}),(0,c.jsx)("input",{type:"checkbox",checked:m,onChange:()=>{r.size===e.length?i(new Set):i(new Set(e.map((e=>e.id))))}})]}),e.map((e=>(0,c.jsxs)("div",{className:"cart-container "+(r.has(e.id)?"active":""),children:[(0,c.jsxs)("div",{className:"cart-item",children:[(0,c.jsx)("img",{src:e.poster_path,alt:e.movieNm,style:{width:"100px",height:"auto",borderRadius:"5px"}}),(0,c.jsxs)("div",{className:"cart-item-info",children:[(0,c.jsxs)("span",{children:["\uc88c\uc11d \ubc88\ud638: ",e.seatNumber]}),(0,c.jsxs)("span",{children:["\uac00\uaca9: ",e.price.toLocaleString(),"\uc6d0"]}),(0,c.jsxs)("span",{children:["\uc0c1\uc601 \ub0a0\uc9dc: ",e.screeningDate]}),(0,c.jsxs)("span",{children:["\uc0c1\uc601 \uc2dc\uac04: ",e.screeningTime]}),(0,c.jsxs)("span",{children:["\uc0c1\uc601\uad00: ",e.theaterName]}),(0,c.jsxs)("span",{children:["\uc601\ud654: ",e.movieNm]}),(0,c.jsxs)("span",{children:["\uc601\ud654\uad00: ",e.cinemaName]})]})]}),(0,c.jsx)("input",{type:"checkbox",checked:r.has(e.id),onChange:()=>{return s=e.id,void i((e=>{const r=new Set(e);return r.has(s)?r.delete(s):r.add(s),r}));var s}})]},e.id))),(0,c.jsxs)("div",{className:"cart-footer",children:[(0,c.jsxs)("h2",{children:["\ucd1d \uac00\uaca9: ",h.toLocaleString(),"\uc6d0"]}),(0,c.jsxs)("div",{className:"button-container",children:[(0,c.jsx)("button",{onClick:async()=>{if(0!==r.size)try{const e=await a.A.delete("http://43.201.20.172:8090/api/cart/delete",{data:{ids:Array.from(r)}});alert(e.data),s((e=>e.filter((e=>!r.has(e.id))))),i(new Set)}catch(o){alert("\uc0ad\uc81c \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}else alert("\uc0ad\uc81c\ud560 \ud56d\ubaa9\uc744 \uc120\ud0dd\ud558\uc138\uc694.")},children:"\uc0ad\uc81c"}),(0,c.jsx)("button",{onClick:()=>{if(0===r.size)return void alert("\uacb0\uc81c\ud560 \ud2f0\ucf13\uc744 \uc120\ud0dd\ud558\uc138\uc694.");const e=Array.from(r);console.log("\uc120\ud0dd\ub41c \uc7a5\ubc14\uad6c\ub2c8 ID:",e),l("/payment/orderSettlement",{state:{cartItemIds:e}})},children:"\uacb0\uc81c\ud558\uae30"})]})]})]}):(0,c.jsx)("span",{children:"\uc7a5\ubc14\uad6c\ub2c8\uc5d0 \ub2f4\uae34 \ud56d\ubaa9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4."})]})})},o=()=>(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(i,{})})},9320:(e,s,r)=>{r.d(s,{A:()=>c});var t=r(6213),a=r(8056);const n=t.A.create();n.interceptors.request.use((e=>{const s=(0,a.Ri)("member");if(!s)return Promise.reject({response:{data:{error:"REQUIRE_LOGIN"}}});const{accessToken:r}=s;return e.headers.Authorization=`Bearer ${r}`,e}),(e=>Promise.reject(e))),n.interceptors.response.use((async e=>{const s=e.data;if(s&&"ERROR_ACCESS_TOKEN"===s.error){const s=(0,a.Ri)("member"),r=await(async(e,s)=>{const r={headers:{Authorization:`Bearer ${e}`}};return(await t.A.get(`http://43.201.20.172:8090/api/member/refresh?refreshToken=${s}`,r)).data})(s.accessToken,s.refreshToken);s.accessToken=r.accessToken,s.refreshToken=r.refreshToken,(0,a.TV)("member",JSON.stringify(s),1);const n=e.config;return n.headers.Authorization=`Bearer ${r.accessToken}`,await(0,t.A)(n)}return e}),(e=>Promise.reject(e)));const c=n}}]);
//# sourceMappingURL=413.1cd749e9.chunk.js.map